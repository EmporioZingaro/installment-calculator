/* ------------------------------------------------------------------
   Fonts
------------------------------------------------------------------ */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Roboto+Mono:wght@400&display=swap');

/* ------------------------------------------------------------------
   Design tokens
------------------------------------------------------------------ */
:root{
  --radius-xl: 14px; --radius-md: 10px; --radius-sm: 8px;
  --shadow: 0 4px 12px rgba(0,0,0,.08);
  --shadow-active: 0 6px 16px rgba(0,0,0,.12); /* More prominent shadow */

  --bg-top: #e8f1ff; --bg-bottom: #ffffff;
  --primary: #0d1b2a; --text: #1f2937;
  --surface: rgba(255,255,255,.78); /* glass */
  --border: rgba(255,255,255,.55);
  --placeholder-text: #6b7280; /* Gray for placeholder */

  --accent: #14b8a6; --accent-hov: #0ea89a;
  --selected: #e0f2f1; /* Lighter teal for selection */

  --transition-duration: 0.4s;
  --transition-timing: ease-in-out;
}

/* ------------------------------------------------------------------
   Base / layout
------------------------------------------------------------------ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{
  font-family:'Inter',system-ui,sans-serif; line-height:1.5;
  background:linear-gradient(180deg,var(--bg-top) 0%,var(--bg-bottom) 70%);
  color:var(--text); min-height:100vh;
  overflow-x: hidden; /* Prevent horizontal scroll during transitions */
}
body{display:flex;justify-content:center;padding:2rem 1rem}

/* gear button */
.gear-btn{
  position:fixed;top:1.25rem;right:1.25rem;width:36px;height:36px;
  background:var(--surface);border:1px solid var(--border);border-radius:50%;
  backdrop-filter:blur(18px) saturate(180%);display:flex;align-items:center;justify-content:center;
  cursor:pointer;box-shadow:var(--shadow);transition:filter .15s; z-index: 50;
}
.gear-btn:hover{filter:brightness(.95)}
.gear-btn img{width:18px;height:18px}

/* container grid */
.container{max-width:1100px;width:100%} /* Slightly wider max-width maybe needed */

/* NEW: Main content grid layout */
.content {
  display: grid;
  /* Left panel takes needed space, Right panel is central & expands, gutters */
  grid-template-columns: minmax(300px, 360px) minmax(400px, 640px);
  gap: 2rem;
  justify-content: center; /* Center the grid columns */
  align-items: start; /* Align panels to the top */
  width: 100%;
}

/* State-based adjustments (applied to .content) */
.state-initial .panel-left {
  transform: translateX(0);
  opacity: 1;
  box-shadow: var(--shadow-active); /* Active initially */
  backdrop-filter: blur(22px) saturate(180%);
}
.state-initial .panel-right {
  opacity: 0.6;
  box-shadow: none;
  backdrop-filter: blur(5px) saturate(100%); /* Less intense blur */
}
.state-initial .placeholder-content {
  opacity: 1;
  height: auto; /* Allow height based on content */
  visibility: visible;
  transition: opacity 0.3s var(--transition-timing) 0.1s, height 0s linear 0.4s, visibility 0s linear 0.4s; /* Fade in, collapse later */
}
.state-initial #cards {
  opacity: 0;
  pointer-events: none;
}

.state-results-visible .panel-left {
  /* Move significantly left, fade slightly */
  transform: translateX(-40%); /* Adjust percentage as needed */
  opacity: 0.7;
  box-shadow: var(--shadow); /* Less prominent shadow */
  backdrop-filter: blur(10px) saturate(120%);
}
.state-results-visible .panel-right {
  opacity: 1;
  box-shadow: var(--shadow-active); /* Active */
  backdrop-filter: blur(22px) saturate(180%);
}
.state-results-visible .placeholder-content {
  opacity: 0;
  height: 0;
  overflow: hidden;
  pointer-events: none;
  visibility: hidden;
  transition: opacity 0.2s var(--transition-timing), height 0s linear 0.2s, visibility 0s linear 0.2s; /* Fade out fast, collapse instantly */
}
.state-results-visible #cards {
  opacity: 1;
  pointer-events: auto;
}

/* panels */
.panel-left,.panel-right{
  padding:2.25rem 2rem 2rem;border-radius:var(--radius-xl);
  background:var(--surface);border:1px solid var(--border);
  transition: transform var(--transition-duration) var(--transition-timing),
              opacity var(--transition-duration) var(--transition-timing),
              box-shadow var(--transition-duration) var(--transition-timing),
              backdrop-filter var(--transition-duration) var(--transition-timing);
}
.panel-left { grid-column: 1 / 2; position: relative; z-index: 10; } /* Ensure left is above if overlap happens */
.panel-right { grid-column: 2 / 3; position: relative; z-index: 5; }

/* header */
.app-header{text-align:center;margin-bottom:1.75rem}
.logo{width:96px;margin:0 auto 1rem}
h1{font-size:1.7rem;font-weight:600;color:var(--primary)}

/* form */
label{font-weight:600;display:block;margin:.85rem 0 .45rem}
input{
  width:100%;padding:.58rem .9rem;font-size:1rem;border-radius:var(--radius-md);
  border:1px solid rgba(0,0,0,.06);background:#fdfdfd;
  box-shadow:inset 0 2px 4px rgba(0,0,0,.04);transition:border .15s,box-shadow .15s;
}
input:focus{
  outline:none;border-color:var(--accent);
  box-shadow:0 0 0 3px rgba(20,184,166,.25),inset 0 2px 4px rgba(0,0,0,.04)
}

/* buttons */
.btn-row{display:flex;gap:.75rem;margin-top:1.25rem}
.btn{cursor:pointer;font-size:1rem;font-weight:600;padding:.55rem 1.2rem;border-radius:var(--radius-md);
     border:1px solid transparent;transition:filter .15s,background .15s}
.btn.primary{background:var(--accent);color:#fff;box-shadow:0 6px 14px rgba(0,0,0,.12)}
.btn.primary:hover{background:var(--accent-hov)}
.btn.secondary{background:#fff;color:var(--text);border-color:rgba(0,0,0,.12)}
.btn.secondary:hover{filter:brightness(.97)}

/* message */
.msg{margin-top:.85rem;font-weight:600;color:#b91c1c; min-height: 1.5em; /* Reserve space */}

/* ------------------------------------------------------------------
   Custom combobox (No changes needed here)
------------------------------------------------------------------ */
.combo{
  display:flex;align-items:center;gap:.5rem;cursor:pointer;
  padding:.55rem .9rem;border:1px solid rgba(0,0,0,.06);
  border-radius:var(--radius-md);background:#fdfdfd;min-height:44px;
  box-shadow:inset 0 2px 4px rgba(0,0,0,.04);
}
.combo:focus{outline:none;border-color:var(--accent);
  box-shadow:0 0 0 3px rgba(20,184,166,.25),inset 0 2px 4px rgba(0,0,0,.04)}
.combo[aria-expanded="true"] .combo-caret{transform:rotate(180deg)}
.combo-icon{width:24px;height:24px;flex:0 0 24px}
.combo-caret{margin-left:auto;transition:transform .2s}
.combo-list{
  position:absolute;z-index:30;margin-top:.25rem;list-style:none;padding:.3rem;
  background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-md);
  backdrop-filter:blur(22px) saturate(180%);box-shadow:var(--shadow);max-height:260px;overflow:auto;
}
.combo-list li{display:flex;align-items:center;gap:.55rem;padding:.45rem .8rem;border-radius:6px;
              cursor:pointer;font-size:.96rem}
.combo-list li:hover,.combo-list li[aria-selected="true"]{background:rgba(0,0,0,.06)}
.combo-list img{width:22px;height:22px}

/* ------------------------------------------------------------------
   Placeholder & Cards grid
------------------------------------------------------------------ */
/* NEW: Placeholder styling */
.placeholder-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 3rem 1rem; /* Add some padding */
  color: var(--placeholder-text);
  min-height: 200px; /* Ensure it has some minimum height */
  /* Transition handled by state classes */
}

.cards-grid{
  display:grid;
  grid-auto-flow:row;
  gap:1rem; /* Slightly reduced gap */
  /* grid-template-columns will be set by JS */
  /* Transition handled by state classes */
  transition: opacity 0.3s var(--transition-timing) 0.1s; /* Fade in slightly after panel activates */
}
.card{
  background: #ffffff; /* Use solid white for cards for contrast */
  border: 1px solid #e5e7eb; /* Subtle border */
  border-radius: var(--radius-sm);
  box-shadow: 0 2px 4px rgba(0,0,0,.05); /* Lighter shadow for cards */
  padding: 1.2rem 1rem 1rem;display:flex;flex-direction:column;align-items:center;
  text-align:center;cursor:pointer;

  /* Card entry animation */
  opacity: 0;
  transform: scale(0.95) translateY(10px);
  transition: opacity 0.3s ease-out,
              transform 0.3s ease-out,
              background-color 0.15s ease-in-out, /* For selection */
              box-shadow 0.2s ease-in-out; /* For hover */
  /* Staggering delay will be added via JS style.transitionDelay */
}

/* Apply entry animation only when results are visible */
.state-results-visible .card {
  opacity: 1;
  transform: scale(1) translateY(0);
}

.card:hover{
  transform: translateY(-3px); /* Lift effect */
  box-shadow: 0 5px 10px rgba(0,0,0,.08);
}
.card.selected{
  background: var(--selected);
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent); /* Outline selection */
}
.card .installments{font-size:1.35rem;font-weight:600;margin-bottom:.35rem;color:var(--primary)}
.card .per{font-family:'Roboto Mono',monospace;font-size:1.25rem;margin-bottom:.55rem}
.card .total,.card .surcharge{font-size:.9rem;line-height:1.3;color:#334155}

/* ------------------------------------------------------------------
   Responsiveness
------------------------------------------------------------------ */
@media(max-width: 960px) {
  .content {
    /* Stack panels on smaller screens */
    grid-template-columns: 1fr;
    gap: 1.5rem;
    justify-content: stretch; /* Allow panels to take full width */
  }
  .panel-left, .panel-right {
    grid-column: 1 / -1; /* Both panels span the single column */
    max-width: 600px; /* Limit width when stacked */
    margin-left: auto;
    margin-right: auto;
  }
  /* Reset transforms when stacked, rely on natural flow */
  .state-results-visible .panel-left {
    transform: translateX(0);
    opacity: 0.85; /* Still slightly deemphasize */
  }
  .cards-grid {
     /* Adjust grid columns for smaller viewports */
     /* JS might need to check viewport width too */
     grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)) !important; /* override JS */
  }
}

@media(max-width: 480px) {
  body { padding: 1rem 0.5rem; }
  .panel-left, .panel-right { padding: 1.5rem 1rem 1.5rem; }
  h1 { font-size: 1.5rem; }
  .card { padding: 1rem 0.8rem; }
  .card .installments { font-size: 1.2rem; }
  .card .per { font-size: 1.1rem; }
  .card .total, .card .surcharge { font-size: 0.85rem; }
  .combo-list{ max-height: 200px; }
}

/* Legacy table hidden - no change needed */
#legacy-table { display: none !important; }
